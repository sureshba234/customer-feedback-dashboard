import React,{useEffect,useState} from 'react';const API=import.meta.env.VITE_API_URL||'http://localhost:8080';export default function FeedbackTable(){const [items,setItems]=useState([]);const [total,setTotal]=useState(0);const [skip,setSkip]=useState(0);const [limit,setLimit]=useState(10);const [search,setSearch]=useState('');const [product,setProduct]=useState('');const [sentiment,setSentiment]=useState('');const load=async ()=>{const params=new URLSearchParams({skip,limit});if(search)params.set('search',search);if(product)params.set('product',product);if(sentiment)params.set('sentiment',sentiment);try{const res=await fetch(`${API}/feedback?`+params.toString());const data=await res.json();if(res.ok){setItems(data.items);setTotal(data.total)}}catch(e){} };useEffect(()=>{load()},[skip,limit]);const pages=Math.ceil(total/limit)||1;const page=Math.floor(skip/limit)+1;return (<div style={{background:'#fff',padding:16,borderRadius:8}}><div style={{display:'flex',gap:8,marginBottom:12}}><input placeholder='Search text' value={search} onChange={e=>setSearch(e.target.value)}/><input placeholder='Filter product' value={product} onChange={e=>setProduct(e.target.value)}/><select value={sentiment} onChange={e=>setSentiment(e.target.value)}><option value=''>All</option><option value='positive'>Positive</option><option value='neutral'>Neutral</option><option value='negative'>Negative</option></select><button onClick={()=>{setSkip(0);load()}}>Apply</button><select value={limit} onChange={e=>{setLimit(parseInt(e.target.value));setSkip(0);}}><option value={5}>5</option><option value={10}>10</option><option value={20}>20</option></select></div><table style={{width:'100%',borderCollapse:'collapse',background:'#fff'}}><thead><tr><th>ID</th><th>Product</th><th>Text</th><th>Sentiment</th><th>Score</th><th>Created</th></tr></thead><tbody>{items.map(it=>(<tr key={it.id}><td>{it.id}</td><td>{it.product}</td><td>{it.text}</td><td>{it.sentiment}</td><td>{(it.score||0).toFixed(3)}</td><td>{new Date(it.created_at).toLocaleString()}</td></tr>))}{items.length===0&&<tr><td colSpan='6' style={{padding:12,color:'#888'}}>No results.</td></tr>}</tbody></table><div style={{display:'flex',gap:8,marginTop:12}}><button onClick={()=>setSkip(Math.max(0,skip-limit))} disabled={skip===0}>Prev</button><span>Page {page}/{pages}</span><button onClick={()=>setSkip(skip+limit)} disabled={skip+limit>=total}>Next</button></div></div>); }